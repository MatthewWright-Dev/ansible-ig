---
  - hosts: localhost
    gather_facts: no
    tasks:
      - name: Create VPC
        ec2_vpc_net:
          name: Module_5_VPC
          cidr_block: 10.10.0.0/16
          region: us-west-1
          tags:
            module: 5
          state: present
          tenancy: dedicated
        register: vpc  
      - name: debug
        debug: var=vpc  
      - name: Create Public Subnet 1
        ec2_vpc_subnet:
          vpc_id: "{{ vpc.vpc.id }}"
          tags:
            Name: Mod5 Public 1
            Module: 5
          cidr: 10.10.0.0/24
          region: us-west-1
          az: us-west-1b
          state: present
      - name: Create Public Subnet 2    
        ec2_vpc_subnet:
          vpc_id: "{{ vpc.vpc.id }}"
          tags:
            Name: Mod5 Public 2
            Module: 5
          cidr: 10.10.1.0/24
          region: us-west-1
          az: us-west-1c
          state: present  
      - name: Create Private Subnet 1
        ec2_vpc_subnet:
          vpc_id: "{{ vpc.vpc.id }}"
          tags:
            Name: Mod5 Private 1
            Module: 5
          cidr: 10.10.2.0/24
          region: us-west-1
          az: us-west-1b
          state: present
      - name: Create Private Subnet 2
        ec2_vpc_subnet:
          vpc_id: "{{ vpc.vpc.id }}"
          tags:
            Name: Mod5 Private 2
            Module: 5
          cidr: 10.10.3.0/24
          region: us-west-1
          az: us-west-1c
          state: present    
      - name: Create Internet Gateway
        ec2_vpc_igw:
          vpc_id: "{{ vpc.vpc.id }}"
          tags:
            Name: Mod5 igateway
            Module: '5'
          state: present